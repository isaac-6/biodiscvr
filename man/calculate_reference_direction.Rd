% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/search_algorithm.R
\name{calculate_reference_direction}
\alias{calculate_reference_direction}
\title{Calculate Reference SSE Direction Vector}
\usage{
calculate_reference_direction(
  reference_dna,
  all_data,
  datasets_to_use,
  get_suvr_function,
  eq_group,
  power_params,
  sse_group = 0,
  verbose = TRUE
)
}
\arguments{
\item{reference_dna}{Numeric vector. The 'dna' representing the reference
biomarker (e.g., a standard composite or a previously known good solution).}

\item{all_data}{List. The complete data structure returned by
\code{preprocess_data()}.}

\item{datasets_to_use}{Character vector. Names of the datasets within
\code{all_data} to include (must match those used in the main fitness function).}

\item{get_suvr_function}{Function. The function to calculate the biomarker
value from 'dna' and a dataset's data frame. Signature: \verb{function(dna, data_df)}.}

\item{eq_group}{Formula. The formula for the within-group SSE models.}

\item{power_params}{List. Parameters for \code{longpower::lmmpower} containing:
\code{pct_change}, \code{t}, \code{power}.}

\item{sse_group}{Integer. Defines the group for SSE calculation: 0 for CI
(DX=1, A+), 1 for CU (DX=0, A+).}

\item{verbose}{Logical. If TRUE, print progress messages. Defaults to TRUE.}
}
\value{
A named numeric vector where names are the dataset names and values
are the calculated reference SSEs. Returns \code{NA} for datasets where the
calculation fails (e.g., insufficient data, model convergence issues).
Returns \code{NULL} if any essential input is invalid.
}
\description{
Calculates the estimated sample size (SSE) for a specific reference
biomarker across multiple cohorts. The resulting vector is typically used as
the \code{direction_reference} argument in \code{calculate_multi_cohort_fitness}.
}
\details{
This function iterates through the specified datasets, calculates the SUVR
for the \emph{single} \code{reference_dna} provided, fits the \code{lmer} model based on
\code{eq_group} for the specified \code{sse_group}, and runs \code{lmmpower} to estimate
the required sample size (SSE). This provides a benchmark SSE vector representing
performance proportionality for the reference biomarker.
}
