% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaluate_biomarkers.R
\name{evaluate_biomarkers}
\alias{evaluate_biomarkers}
\title{Evaluate Discovered Biomarkers Across Multiple Datasets and Groups}
\usage{
evaluate_biomarkers(
  discovery_results_csv_path,
  prepared_data_list,
  config,
  datasets_to_evaluate = names(prepared_data_list),
  groups_to_evaluate = c("CU", "CI"),
  calculate_ci = FALSE,
  nsim = 100,
  output_evaluation_csv_path = NULL,
  id_col = NULL,
  verbose = TRUE
)
}
\arguments{
\item{discovery_results_csv_path}{Character string. Path to the input CSV file
containing biomarker discovery results (typically generated by \code{run_experiments}).
Expected columns include \code{regs_numerator}, \code{regs_denominator}, \code{var_composition},
and ideally identifiers like \code{discovery_dataset}, \code{experiment_tag}.}

\item{prepared_data_list}{List. The output from \code{preprocess_data()},
containing filtered data for multiple datasets (e.g., \code{list(ADNI=list(data=..., data_suv_bi=...), MAYO=...)}).}

\item{config}{List. The loaded main configuration object (output from
\code{preprocess_data$config}). Must contain sections like
\code{preprocessing}, \code{model_equations}, \code{power_params}.}

\item{datasets_to_evaluate}{Character vector. Names of the datasets within
\code{prepared_data_list} to evaluate the biomarkers on. Defaults to using all
datasets present in \code{prepared_data_list}.}

\item{groups_to_evaluate}{Character vector. Groups ("CU", "CI") to evaluate
within each dataset. Defaults to \code{c("CU", "CI")}.}

\item{calculate_ci}{Logical. If \code{TRUE}, calculate and return bootstrap/estimated
95\% confidence intervals using \code{.feval_group_95CI}. Defaults to \code{FALSE}.}

\item{nsim}{Integer. Number of bootstrap simulations if \code{calculate_ci} is \code{TRUE}.
Defaults to 100. Ignored if \code{calculate_ci} is \code{FALSE}.}

\item{output_evaluation_csv_path}{Character string or NULL. If provided, the full
path to save the \emph{evaluation} results table as a \emph{new} CSV file. If the file
exists, it will be overwritten. Directory created if needed.}

\item{id_col}{Character string. Name of the unique individual identifier column,
used for merging and checking data. Fetched from config if possible, defaults
to "RID".}

\item{verbose}{Logical. Print progress messages? Defaults to TRUE.}
}
\value{
A data frame containing the evaluation results. Each row corresponds to
one discovered biomarker evaluated on one specific dataset and group. Columns
include identifiers from the input CSV, evaluation context (dataset, group),
evaluation status, and the calculated metrics (Rep, SepAB, SSE, plus CIs
if requested). Returns \code{NULL} if the input CSV cannot be read or essential
data is missing.
}
\description{
Reads biomarker definitions from a discovery results file and evaluates their
performance (Repeatability, Separation, Sample Size Estimate) on specified
datasets and diagnostic groups (CU/CI), optionally calculating confidence intervals.
Evaluation is performed dataset-by-dataset, group-by-group.
}
\details{
Workflow:
\enumerate{
\item Reads the \code{discovery_results_csv_path}.
\item Iterates through each dataset in \code{datasets_to_evaluate}.
\item For each dataset, identifies available features and prepares clinical data.
\item Iterates through each group in \code{groups_to_evaluate}.
\item For each dataset/group combination, iterates through each row (discovered biomarker)
in the discovery results file.
\item Validates that the biomarker's required regions exist in the current dataset.
\item Reconstructs a 'chromosome' vector based on the biomarker's definition and
the available features for the current dataset.
\item Calls internal \code{.calculate_cvr} to compute the biomarker value.
\item Merges the calculated value with the clinical data.
\item Checks for sufficient data in the specific dataset/group combination.
\item Calls \code{.feval_group} (or \code{.feval_group_95CI}) to get performance metrics.
\item Records the metrics along with discovery identifiers and evaluation context.
\item Combines all results into a single data frame after all loops complete.
\item Optionally saves the results table to \code{output_evaluation_csv_path}.
}
}
