% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_experiments.R
\name{run_experiments}
\alias{run_experiments}
\title{Run a Defined Set of Single- and Multi-Cohort Discovery Experiments}
\usage{
run_experiments(
  prepared_data_list,
  config,
  experiments_config_path,
  output_csv_name,
  output_dir = NULL,
  save_plots = TRUE,
  datasets_to_run = names(prepared_data_list),
  experiment_master_tag = format(Sys.time(), "\%Y\%m\%d"),
  base_ga_seed = 42
)
}
\arguments{
\item{prepared_data_list}{List. The output from \code{preprocess_datasets()},
containing filtered data for multiple datasets (e.g., \code{list(ADNI=list(data=..., data_suv_bi=...), MAYO=...)}).}

\item{config}{List. The loaded main configuration object (output from
\code{check_and_prepare_data$config}). Must contain sections like
\code{preprocessing}, \code{model_equations}, \code{power_params}, \code{genetic_algorithm}.}

\item{experiments_config_path}{Character string. Path to the YAML file defining
the experiments to run. See Details for expected structure.}

\item{output_csv_name}{Character string. Full path to the CSV file where
results from ALL experimental runs (single and multi-cohort) will be appended.
The file will be created with headers if it doesn't exist. Directory created if needed.}

\item{output_dir}{Character string or NULL. Path to the directory where
GA convergence plots from \emph{single-cohort} runs should be saved.
If NULL, plots are not saved. Directory created if needed.}

\item{save_plots}{Logical. If \code{TRUE} (and \code{output_dir} is provided),
save the GA convergence plot for each single-cohort run. Defaults to \code{TRUE}.
(Note: Multi-cohort plot saving might need separate handling if desired).}

\item{datasets_to_run}{Character vector. Names of the datasets within
\code{prepared_data_list} to include in the experiments (e.g., \code{c("ADNI", "MAYO")}).
Defaults to using all datasets present in \code{prepared_data_list}.}

\item{experiment_master_tag}{Character string. An overall tag prepended to
individual run tags for easier filtering of results. Defaults to the
current date (YYYYMMDD).}

\item{base_ga_seed}{Numeric or NULL. A base seed for the GA runs. If provided,
a unique seed derived from this base (\code{base_ga_seed + run_counter}) will be
used for each GA run for reproducibility. If NULL, random seeds are used.}
}
\value{
Invisibly returns a list containing the path to the main output CSV file
and potentially other summary information or paths generated during the run.
The primary output is the side effect of appending results to the CSV file.
}
\description{
Orchestrates multiple biomarker discovery runs using specified single-cohort
(\code{biodiscvr_single}) and multi-cohort (\code{biodiscvr_multicohort}) functions.
Executes a sequence of experiments defined in a configuration file, including
baseline discovery, runs with predefined fixed regions, optional second-iteration
runs based on initial fixed-region results, and finally multi-cohort optimization
using single-cohort results as reference. All primary results are appended to
a single CSV file.
}
\details{
\strong{Workflow:}
\enumerate{
\item Loads experiment definitions from \code{experiments_config_path}.
\item Identifies features common across all specified \code{datasets_to_run}.
\item Validates any fixed regions defined in experiments against common features.
\item \strong{Single-Cohort Phase:} Iterates through each experiment definition:
\itemize{
\item Runs \code{biodiscvr_single} for CU and CI groups on each dataset.
\item If an experiment uses fixed regions and \code{run_second_iteration} is TRUE,
it immediately runs a second iteration fixing the regions found in the
first iteration (fixing numerator if denominator was initially fixed, and vice-versa).
\item Appends results of each \code{biodiscvr_single} run to \code{output_csv_name}.
\item Stores the single-cohort fitness values achieved in the first iteration runs.
}
\item \strong{Multi-Cohort Phase:} Iterates through each experiment definition again:
\itemize{
\item Retrieves the stored single-cohort fitness values for the current experiment/group
to be used as the \code{reference_fitness} vector.
\item Calls \code{biodiscvr_multicohort} to perform optimization across all
\code{datasets_to_run} simultaneously, using the reference fitness.
\item Appends the main result row from \code{biodiscvr_multicohort} to the \emph{same}
\code{output_csv_name}.
\item (Note: Per-dataset metrics from multi-cohort are returned by the function
but not automatically logged to the main CSV in this implementation).
}
}

\strong{Experiments Configuration (\code{experiments.yaml}):}
Should be a YAML file with a top-level key \code{experiments}. Each key under
\code{experiments} defines a unique run configuration:

\if{html}{\out{<div class="sourceCode yaml">}}\preformatted{experiments:
  ExperimentName1:
    description: "A brief description"
    fixed_numerator_regs: NULL # or list ["RegionA", "RegionB"]
    fixed_denominator_regs: NULL # or list ["RegionC"]
    run_second_iteration: FALSE # or TRUE (only relevant if one side is fixed)
  ExperimentName2:
    # ... other definitions ...
}\if{html}{\out{</div>}}
}
